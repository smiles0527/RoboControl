<UserControl x:Class="ControlWorkbench.App.Views.VexPathPlannerView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d" 
             d:DesignHeight="700" d:DesignWidth="1200"
             Background="#1E1E1E">
    
    <UserControl.Resources>
        <Style TargetType="Button" x:Key="ToolButton">
            <Setter Property="Width" Value="40"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="Margin" Value="2"/>
            <Setter Property="Background" Value="#3E3E42"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#4E4E52"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        
        <Style TargetType="TextBlock" x:Key="LabelStyle">
            <Setter Property="Foreground" Value="#CCCCCC"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Margin" Value="0,5,0,2"/>
        </Style>
        
        <Style TargetType="TextBox" x:Key="InputStyle">
            <Setter Property="Background" Value="#3E3E42"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#555555"/>
            <Setter Property="Padding" Value="5,3"/>
            <Setter Property="Margin" Value="0,0,0,5"/>
        </Style>
    </UserControl.Resources>
    
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="250"/>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="300"/>
        </Grid.ColumnDefinitions>
        
        <!-- Left Panel - Path List and Tools -->
        <Border Grid.Column="0" Background="#2D2D30" Margin="5">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel Margin="10">
                    <TextBlock Text="VEX Path Planner" FontSize="18" FontWeight="Bold" Foreground="White" Margin="0,0,0,15"/>
                    
                    <!-- Game Selection -->
                    <TextBlock Text="VRC Game" Style="{StaticResource LabelStyle}"/>
                    <ComboBox x:Name="GameCombo" SelectedIndex="0" Margin="0,0,0,10">
                        <ComboBoxItem Content="High Stakes (2024-25)"/>
                        <ComboBoxItem Content="Over Under (2023-24)"/>
                        <ComboBoxItem Content="Spin Up (2022-23)"/>
                    </ComboBox>
                    
                    <!-- Alliance Selection -->
                    <TextBlock Text="Alliance" Style="{StaticResource LabelStyle}"/>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <RadioButton x:Name="RedAlliance" Content="Red" Foreground="#FF6B6B" IsChecked="True" Margin="0,0,20,0"/>
                        <RadioButton x:Name="BlueAlliance" Content="Blue" Foreground="#6B9FFF"/>
                    </StackPanel>
                    
                    <!-- Starting Position -->
                    <TextBlock Text="Starting Position" Style="{StaticResource LabelStyle}"/>
                    <ComboBox x:Name="StartPosCombo" SelectedIndex="0" Margin="0,0,0,15">
                        <ComboBoxItem Content="Positive Corner (+)"/>
                        <ComboBoxItem Content="Negative Corner (-)"/>
                        <ComboBoxItem Content="Skills Start"/>
                    </ComboBox>
                    
                    <Separator Background="#555555" Margin="0,5,0,15"/>
                    
                    <!-- Paths List -->
                    <TextBlock Text="Paths" Style="{StaticResource LabelStyle}" FontWeight="Bold"/>
                    <ListBox x:Name="PathsList" Background="#3E3E42" Foreground="White" Height="120" Margin="0,0,0,10">
                        <ListBoxItem Content="Red Positive Auton" IsSelected="True"/>
                        <ListBoxItem Content="Red Negative Auton"/>
                        <ListBoxItem Content="Blue Positive Auton"/>
                        <ListBoxItem Content="Skills Run"/>
                    </ListBox>
                    
                    <StackPanel Orientation="Horizontal">
                        <Button Content="New" Style="{StaticResource ToolButton}" Width="70" Click="NewPath_Click"/>
                        <Button Content="Copy" Style="{StaticResource ToolButton}" Width="70" Click="CopyPath_Click"/>
                        <Button Content="Delete" Style="{StaticResource ToolButton}" Width="70" Click="DeletePath_Click"/>
                    </StackPanel>
                    
                    <Separator Background="#555555" Margin="0,15,0,15"/>
                    
                    <!-- Drawing Tools -->
                    <TextBlock Text="Tools" Style="{StaticResource LabelStyle}" FontWeight="Bold"/>
                    <WrapPanel Margin="0,5,0,0">
                        <Button Content="WP" ToolTip="Add Waypoint" Style="{StaticResource ToolButton}" Click="AddWaypoint_Click"/>
                        <Button Content="Turn" ToolTip="Add Turn Point" Style="{StaticResource ToolButton}" Width="50" Click="AddTurn_Click"/>
                        <Button Content="Wait" ToolTip="Add Wait Action" Style="{StaticResource ToolButton}" Width="50"/>
                        <Button Content="Mogo" ToolTip="Grab Mobile Goal" Style="{StaticResource ToolButton}" Width="50"/>
                        <Button Content="Ring" ToolTip="Score Ring" Style="{StaticResource ToolButton}" Width="50"/>
                        <Button Content="Clamp" ToolTip="Toggle Clamp" Style="{StaticResource ToolButton}" Width="55"/>
                    </WrapPanel>
                    <WrapPanel Margin="0,5,0,0">
                        <Button Content="Undo" ToolTip="Undo" Style="{StaticResource ToolButton}" Width="55" Click="Undo_Click"/>
                        <Button Content="Redo" ToolTip="Redo" Style="{StaticResource ToolButton}" Width="55" Click="Redo_Click"/>
                        <Button Content="Clear" ToolTip="Clear Path" Style="{StaticResource ToolButton}" Width="55" Click="ClearPath_Click"/>
                    </WrapPanel>
                    
                    <Separator Background="#555555" Margin="0,15,0,15"/>
                    
                    <!-- Path Settings -->
                    <TextBlock Text="Path Settings" Style="{StaticResource LabelStyle}" FontWeight="Bold"/>
                    
                    <TextBlock Text="Max Velocity (in/s)" Style="{StaticResource LabelStyle}"/>
                    <Slider x:Name="MaxVelSlider" Minimum="20" Maximum="100" Value="60"/>
                    <TextBlock Text="{Binding Value, ElementName=MaxVelSlider, StringFormat='{}{0:F0} in/s'}" Foreground="#888888" FontSize="10"/>
                    
                    <TextBlock Text="Lookahead Distance (in)" Style="{StaticResource LabelStyle}"/>
                    <Slider x:Name="LookaheadSlider" Minimum="6" Maximum="24" Value="12"/>
                    <TextBlock Text="{Binding Value, ElementName=LookaheadSlider, StringFormat='{}{0:F0} in'}" Foreground="#888888" FontSize="10"/>
                </StackPanel>
            </ScrollViewer>
        </Border>
        
        <!-- Center - Field Canvas -->
        <Border Grid.Column="1" Background="#252526" Margin="5">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <!-- Toolbar -->
                <StackPanel Grid.Row="0" Orientation="Horizontal" Background="#2D2D30" Height="40">
                    <Button x:Name="SimulateBtn" Content="Simulate" Width="90" Margin="5" Background="#4CAF50" Foreground="White" Click="Simulate_Click"/>
                    <Button x:Name="StopBtn" Content="Stop" Width="60" Margin="5" Click="Stop_Click"/>
                    <Separator Width="1" Background="#555555" Margin="5"/>
                    <Button Content="+" Width="30" Margin="2" ToolTip="Zoom In" Click="ZoomIn_Click"/>
                    <Button Content="-" Width="30" Margin="2" ToolTip="Zoom Out" Click="ZoomOut_Click"/>
                    <Button Content="Reset" Width="60" Margin="5" Click="ResetView_Click"/>
                    <Separator Width="1" Background="#555555" Margin="5"/>
                    <CheckBox x:Name="ShowGridCheck" Content="Grid" IsChecked="True" Foreground="White" VerticalAlignment="Center" Margin="10,0"/>
                    <CheckBox x:Name="ShowCurvatureCheck" Content="Curvature" IsChecked="True" Foreground="White" VerticalAlignment="Center" Margin="10,0"/>
                    <CheckBox x:Name="ShowVelocityCheck" Content="Velocity" IsChecked="True" Foreground="White" VerticalAlignment="Center" Margin="10,0"/>
                </StackPanel>
                
                <!-- Field Canvas -->
                <Canvas x:Name="FieldCanvas" Grid.Row="1" Background="#333333" ClipToBounds="True"
                        MouseLeftButtonDown="FieldCanvas_MouseLeftButtonDown"
                        MouseLeftButtonUp="FieldCanvas_MouseLeftButtonUp"
                        MouseMove="FieldCanvas_MouseMove"
                        MouseWheel="FieldCanvas_MouseWheel"
                        MouseRightButtonDown="FieldCanvas_MouseRightButtonDown">
                    
                    <Canvas.ContextMenu>
                        <ContextMenu>
                            <MenuItem Header="Add Waypoint Here" Click="AddWaypointHere_Click"/>
                            <MenuItem Header="Add Turn Point" Click="AddTurnHere_Click"/>
                            <Separator/>
                            <MenuItem Header="Add Action">
                                <MenuItem Header="Score on Stake"/>
                                <MenuItem Header="Grab Mobile Goal"/>
                                <MenuItem Header="Release Mobile Goal"/>
                                <MenuItem Header="Toggle Intake"/>
                                <MenuItem Header="Wait (ms)..."/>
                            </MenuItem>
                            <Separator/>
                            <MenuItem Header="Delete Selected Point" Click="DeletePoint_Click"/>
                        </ContextMenu>
                    </Canvas.ContextMenu>
                </Canvas>
                
                <!-- Timeline -->
                <Border Grid.Row="2" Background="#2D2D30" Height="60">
                    <Grid Margin="10,5">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Timeline: " Foreground="#888888"/>
                            <TextBlock x:Name="TimelineText" Text="0.0s / 3.2s" Foreground="White"/>
                            <TextBlock Text="  |  Distance: " Foreground="#888888" Margin="20,0,0,0"/>
                            <TextBlock x:Name="DistanceText" Text="0.0 / 48.5 in" Foreground="White"/>
                            <TextBlock Text="  |  Waypoints: " Foreground="#888888" Margin="20,0,0,0"/>
                            <TextBlock x:Name="WaypointCountText" Text="5" Foreground="White"/>
                        </StackPanel>
                        
                        <Slider Grid.Row="1" x:Name="TimelineSlider" Minimum="0" Maximum="100" Value="0" Margin="0,5,0,0"
                                ValueChanged="TimelineSlider_ValueChanged"/>
                    </Grid>
                </Border>
            </Grid>
        </Border>
        
        <!-- Right Panel - Waypoint Details and Code -->
        <Border Grid.Column="2" Background="#2D2D30" Margin="5">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel Margin="10">
                    <!-- Selected Waypoint -->
                    <TextBlock Text="Selected Waypoint" FontSize="16" FontWeight="Bold" Foreground="White" Margin="0,0,0,10"/>
                    
                    <Border Background="#3E3E42" Padding="10" CornerRadius="5" Margin="0,0,0,15">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="100"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <TextBlock Grid.Row="0" Grid.Column="0" Text="X (inches):" Foreground="#AAAAAA" Margin="0,5"/>
                            <TextBox Grid.Row="0" Grid.Column="1" x:Name="WaypointX" Text="24.0" Style="{StaticResource InputStyle}" 
                                     TextChanged="WaypointValue_Changed"/>
                            
                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Y (inches):" Foreground="#AAAAAA" Margin="0,5"/>
                            <TextBox Grid.Row="1" Grid.Column="1" x:Name="WaypointY" Text="36.0" Style="{StaticResource InputStyle}"
                                     TextChanged="WaypointValue_Changed"/>
                            
                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Heading (deg):" Foreground="#AAAAAA" Margin="0,5"/>
                            <TextBox Grid.Row="2" Grid.Column="1" x:Name="WaypointHeading" Text="90" Style="{StaticResource InputStyle}"
                                     TextChanged="WaypointValue_Changed"/>
                            
                            <TextBlock Grid.Row="3" Grid.Column="0" Text="Velocity (%):" Foreground="#AAAAAA" Margin="0,5"/>
                            <TextBox Grid.Row="3" Grid.Column="1" x:Name="WaypointVel" Text="100" Style="{StaticResource InputStyle}"
                                     TextChanged="WaypointValue_Changed"/>
                        </Grid>
                    </Border>
                    
                    <!-- Actions at Waypoint -->
                    <TextBlock Text="Actions at Waypoint" Style="{StaticResource LabelStyle}" FontWeight="Bold"/>
                    <ListBox x:Name="ActionsList" Background="#3E3E42" Foreground="White" Height="80" Margin="0,5,0,10">
                        <ListBoxItem Content="Wait 200ms"/>
                        <ListBoxItem Content="Grab Mobile Goal"/>
                    </ListBox>
                    <Button Content="+ Add Action" Background="#3E3E42" Foreground="White" Margin="0,0,0,15"/>
                    
                    <Separator Background="#555555" Margin="0,5,0,15"/>
                    
                    <!-- Path Statistics -->
                    <TextBlock Text="Path Statistics" FontSize="14" FontWeight="Bold" Foreground="White" Margin="0,0,0,10"/>
                    <Border Background="#3E3E42" Padding="10" CornerRadius="5" Margin="0,0,0,15">
                        <StackPanel>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="Total Distance: " Foreground="#888888"/>
                                <TextBlock x:Name="TotalDistanceText" Text="48.5 in" Foreground="White"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="Estimated Time: " Foreground="#888888"/>
                                <TextBlock x:Name="TotalTimeText" Text="3.2s" Foreground="White"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="Waypoints: " Foreground="#888888"/>
                                <TextBlock x:Name="WaypointStatsText" Text="5" Foreground="White"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="Max Curvature: " Foreground="#888888"/>
                                <TextBlock x:Name="MaxCurvatureText" Text="0.08 /in" Foreground="White"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                    
                    <Separator Background="#555555" Margin="0,5,0,15"/>
                    
                    <!-- Export Options -->
                    <TextBlock Text="Export" FontSize="14" FontWeight="Bold" Foreground="White" Margin="0,0,0,10"/>
                    
                    <Button Content="Copy LemLib Code" Background="#0078D4" Foreground="White" Padding="10,8" Margin="0,0,0,5"
                            Click="CopyLemLibCode_Click"/>
                    <Button Content="Copy Pure Pursuit Code" Background="#0078D4" Foreground="White" Padding="10,8" Margin="0,0,0,5"
                            Click="CopyPurePursuitCode_Click"/>
                    <Button Content="Save Path (.json)" Background="#3E3E42" Foreground="White" Padding="10,8" Margin="0,0,0,5"
                            Click="SavePath_Click"/>
                    <Button Content="Load Path" Background="#3E3E42" Foreground="White" Padding="10,8" Margin="0,0,0,15"
                            Click="LoadPath_Click"/>
                    
                    <Separator Background="#555555" Margin="0,5,0,15"/>
                    
                    <!-- Quick Code Preview -->
                    <TextBlock Text="Code Preview" FontSize="14" FontWeight="Bold" Foreground="White" Margin="0,0,0,10"/>
                    <Border Background="#1E1E1E" Padding="10" CornerRadius="5">
                        <TextBox x:Name="CodePreview" 
                                 FontFamily="Consolas" 
                                 FontSize="11" 
                                 Foreground="#9CDCFE"
                                 Background="Transparent"
                                 BorderThickness="0"
                                 IsReadOnly="True"
                                 TextWrapping="Wrap"
                                 AcceptsReturn="True"
                                 Height="180"
                                 VerticalScrollBarVisibility="Auto"/>
                    </Border>
                </StackPanel>
            </ScrollViewer>
        </Border>
    </Grid>
</UserControl>
